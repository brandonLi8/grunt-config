# Copyright © 2019-2020 Brandon Li. All rights reserved.

#!————————————————————————————————————————————————————————————————————————————*!
# GitHub action that instructs GitHub to run `grunt update-copyright` to update
# every file's copyright date every year. See `grunt-config/src/Copyright` for
# information on correct copyright statements. See
# https://help.github.com/en/actions for more documentation on GitHub actions.
#
# IMPORTANT: This file was auto-generated by `grunt generate-update-copyright`.
#            It is recommended to not modify this file. For more information,
#            see https://github.com/brandonLi8/grunt-config/.
#
# @author Brandon Li <brandon.li820@gmail.com>
#!————————————————————————————————————————————————————————————————————————————*!
name: Update All Copyrights        # tentative workflow name
on:
  schedule:

            # ┌───────────── minute (0 - 59)
            # │ ┌───────────── hour (0 - 23)
            # │ │ ┌───────────── day of the month (1 - 31)
            # │ │ │ ┌───────────── month (1 - 12 or JAN-DEC)
            # │ │ │ │ ┌───────────── day of the week (0 - 6 or SUN-SAT)
            # │ │ │ │ │
            # │ │ │ │ │
            # │ │ │ │ │
            # * * * * *
    - cron:  '27 23 2 1 *'            # activate on every new year's day.
                                    #

jobs:
  build:
    name: Update All Copyrights     # tentative workflow name
    runs-on: ubuntu-latest

    steps:                          # checkout and set up node
    - uses: actions/checkout@v1     # ensure a fresh checkout of source code

    - name: Setup Node              # setup Node.js
      uses: actions/setup-node@v1

    - name: npm stability           # ensure the stability of npm
      run: |
        npm prune -production=true  # prune for a fresh node_modules directory
        npm cache clean --f         # clear the cache
        npm install                 # install dependencies

    - name: Update Copyrights       # ensure copyright statements are updated.
      run: grunt update-copyright

    - name: Commit Local Changes
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git commit -am "run grunt update-copyright"

    # Push Local Changes. See https://github.com/ad-m/github-push-action.
    - name: Push Local Changes
      uses: ad-m/github-push-action@master
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}